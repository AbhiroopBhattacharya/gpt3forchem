diff --git a/experiments/08_explore_photoswitch_learning.ipynb b/experiments/08_explore_photoswitch_learning.ipynb
index ab8667e..27908ba 100644
--- a/experiments/08_explore_photoswitch_learning.ipynb
+++ b/experiments/08_explore_photoswitch_learning.ipynb
@@ -9,12 +9,15 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 1,
+   "execution_count": 12,
    "metadata": {},
    "outputs": [],
    "source": [
     "from gpt3forchem.data import get_photoswitch_data\n",
-    "from gpt3forchem.input import create_single_property_forward_prompts\n"
+    "from gpt3forchem.input import create_single_property_forward_prompts\n",
+    "from sklearn.model_selection import train_test_split\n",
+    "from gpt3forchem.api_wrappers import fine_tune\n",
+    "import time"
    ]
   },
   {
@@ -28,7 +31,30 @@
   },
   {
    "cell_type": "code",
-   "execution_count": 5,
+   "execution_count": 7,
+   "metadata": {},
+   "outputs": [],
+   "source": [
+    "prompts = create_single_property_forward_prompts(\n",
+    "    data,\n",
+    "    \"wavelength_cat\",\n",
+    "    {\"wavelength_cat\": \"transition wavelength\"},\n",
+    "    representation_col=\"SMILES\",\n",
+    ")\n"
+   ]
+  },
+  {
+   "cell_type": "code",
+   "execution_count": 8,
+   "metadata": {},
+   "outputs": [],
+   "source": [
+    "train_prompts, test_prompts = train_test_split(prompts, test_size=0.2, random_state=None)\n"
+   ]
+  },
+  {
+   "cell_type": "code",
+   "execution_count": 10,
    "metadata": {},
    "outputs": [
     {
@@ -58,29 +84,29 @@
        "  </thead>\n",
        "  <tbody>\n",
        "    <tr>\n",
-       "      <th>0</th>\n",
-       "      <td>what is the transition wavelength of C[N]1N=NC...</td>\n",
+       "      <th>3</th>\n",
+       "      <td>what is the transition wavelength of C[N]1C=C(...</td>\n",
        "      <td>0@@@</td>\n",
        "    </tr>\n",
        "    <tr>\n",
-       "      <th>1</th>\n",
-       "      <td>what is the transition wavelength of C[N]1C=NC...</td>\n",
-       "      <td>0@@@</td>\n",
+       "      <th>332</th>\n",
+       "      <td>what is the transition wavelength of Cc1[nH]c2...</td>\n",
+       "      <td>1@@@</td>\n",
        "    </tr>\n",
        "    <tr>\n",
-       "      <th>2</th>\n",
-       "      <td>what is the transition wavelength of C[N]1C=CC...</td>\n",
-       "      <td>0@@@</td>\n",
+       "      <th>289</th>\n",
+       "      <td>what is the transition wavelength of OCCN(CCO)...</td>\n",
+       "      <td>1@@@</td>\n",
        "    </tr>\n",
        "    <tr>\n",
-       "      <th>3</th>\n",
-       "      <td>what is the transition wavelength of C[N]1C=C(...</td>\n",
-       "      <td>0@@@</td>\n",
+       "      <th>363</th>\n",
+       "      <td>what is the transition wavelength of COC(C=C4)...</td>\n",
+       "      <td>1@@@</td>\n",
        "    </tr>\n",
        "    <tr>\n",
-       "      <th>4</th>\n",
-       "      <td>what is the transition wavelength of C[N]1C=C(...</td>\n",
-       "      <td>0@@@</td>\n",
+       "      <th>247</th>\n",
+       "      <td>what is the transition wavelength of CC(C=C(N(...</td>\n",
+       "      <td>2@@@</td>\n",
        "    </tr>\n",
        "    <tr>\n",
        "      <th>...</th>\n",
@@ -88,565 +114,85 @@
        "      <td>...</td>\n",
        "    </tr>\n",
        "    <tr>\n",
-       "      <th>387</th>\n",
-       "      <td>what is the transition wavelength of OC%38=C%3...</td>\n",
-       "      <td>2@@@</td>\n",
+       "      <th>135</th>\n",
+       "      <td>what is the transition wavelength of CC1=CC=CC...</td>\n",
+       "      <td>0@@@</td>\n",
        "    </tr>\n",
        "    <tr>\n",
-       "      <th>388</th>\n",
-       "      <td>what is the transition wavelength of OC%42=C%4...</td>\n",
-       "      <td>2@@@</td>\n",
+       "      <th>50</th>\n",
+       "      <td>what is the transition wavelength of O=C(COC1=...</td>\n",
+       "      <td>0@@@</td>\n",
        "    </tr>\n",
        "    <tr>\n",
-       "      <th>389</th>\n",
-       "      <td>what is the transition wavelength of N#CC1C(SC...</td>\n",
+       "      <th>219</th>\n",
+       "      <td>what is the transition wavelength of [H]C1=CC(...</td>\n",
        "      <td>3@@@</td>\n",
        "    </tr>\n",
        "    <tr>\n",
-       "      <th>390</th>\n",
-       "      <td>what is the transition wavelength of N#Cc5c(c6...</td>\n",
-       "      <td>3@@@</td>\n",
+       "      <th>281</th>\n",
+       "      <td>what is the transition wavelength of CC(O)C1=C...</td>\n",
+       "      <td>1@@@</td>\n",
        "    </tr>\n",
        "    <tr>\n",
-       "      <th>391</th>\n",
-       "      <td>what is the transition wavelength of N#CC9C(SC...</td>\n",
-       "      <td>3@@@</td>\n",
+       "      <th>249</th>\n",
+       "      <td>what is the transition wavelength of CC(C=C(N(...</td>\n",
+       "      <td>2@@@</td>\n",
        "    </tr>\n",
        "  </tbody>\n",
        "</table>\n",
-       "<p>392 rows × 2 columns</p>\n",
+       "<p>313 rows × 2 columns</p>\n",
        "</div>"
       ],
       "text/plain": [
        "                                                prompt completion\n",
-       "0    what is the transition wavelength of C[N]1N=NC...       0@@@\n",
-       "1    what is the transition wavelength of C[N]1C=NC...       0@@@\n",
-       "2    what is the transition wavelength of C[N]1C=CC...       0@@@\n",
        "3    what is the transition wavelength of C[N]1C=C(...       0@@@\n",
-       "4    what is the transition wavelength of C[N]1C=C(...       0@@@\n",
+       "332  what is the transition wavelength of Cc1[nH]c2...       1@@@\n",
+       "289  what is the transition wavelength of OCCN(CCO)...       1@@@\n",
+       "363  what is the transition wavelength of COC(C=C4)...       1@@@\n",
+       "247  what is the transition wavelength of CC(C=C(N(...       2@@@\n",
        "..                                                 ...        ...\n",
-       "387  what is the transition wavelength of OC%38=C%3...       2@@@\n",
-       "388  what is the transition wavelength of OC%42=C%4...       2@@@\n",
-       "389  what is the transition wavelength of N#CC1C(SC...       3@@@\n",
-       "390  what is the transition wavelength of N#Cc5c(c6...       3@@@\n",
-       "391  what is the transition wavelength of N#CC9C(SC...       3@@@\n",
+       "135  what is the transition wavelength of CC1=CC=CC...       0@@@\n",
+       "50   what is the transition wavelength of O=C(COC1=...       0@@@\n",
+       "219  what is the transition wavelength of [H]C1=CC(...       3@@@\n",
+       "281  what is the transition wavelength of CC(O)C1=C...       1@@@\n",
+       "249  what is the transition wavelength of CC(C=C(N(...       2@@@\n",
        "\n",
-       "[392 rows x 2 columns]"
+       "[313 rows x 2 columns]"
       ]
      },
-     "execution_count": 5,
+     "execution_count": 10,
      "metadata": {},
      "output_type": "execute_result"
     }
    ],
    "source": [
-    "create_single_property_forward_prompts(\n",
-    "    data,\n",
-    "    \"wavelength_cat\",\n",
-    "    {\"wavelength_cat\": \"transition wavelength\"},\n",
-    "    representation_col=\"SMILES\",\n",
-    ")\n"
+    "train_prompts"
    ]
   },
   {
    "cell_type": "code",
-   "execution_count": 4,
+   "execution_count": 13,
    "metadata": {},
-   "outputs": [
-    {
-     "data": {
-      "text/html": [
-       "<div>\n",
-       "<style scoped>\n",
-       "    .dataframe tbody tr th:only-of-type {\n",
-       "        vertical-align: middle;\n",
-       "    }\n",
-       "\n",
-       "    .dataframe tbody tr th {\n",
-       "        vertical-align: top;\n",
-       "    }\n",
-       "\n",
-       "    .dataframe thead th {\n",
-       "        text-align: right;\n",
-       "    }\n",
-       "</style>\n",
-       "<table border=\"1\" class=\"dataframe\">\n",
-       "  <thead>\n",
-       "    <tr style=\"text-align: right;\">\n",
-       "      <th></th>\n",
-       "      <th>index</th>\n",
-       "      <th>SMILES</th>\n",
-       "      <th>rate of thermal isomerisation from Z-E in s-1</th>\n",
-       "      <th>Solvent used for thermal isomerisation rates</th>\n",
-       "      <th>Z PhotoStationaryState</th>\n",
-       "      <th>E PhotoStationaryState</th>\n",
-       "      <th>E isomer pi-pi* wavelength in nm</th>\n",
-       "      <th>Extinction</th>\n",
-       "      <th>E isomer n-pi* wavelength in nm</th>\n",
-       "      <th>Extinction coefficient in M-1 cm-1</th>\n",
-       "      <th>...</th>\n",
-       "      <th>CAM-B3LYP/6-31G** DFT E isomer n-pi* wavelength in nm</th>\n",
-       "      <th>CAM-B3LYP/6-31G** DFT Z isomer pi-pi* wavelength in nm</th>\n",
-       "      <th>CAM-B3LYP/6-31G** DFT Z isomer n-pi* wavelength in nm</th>\n",
-       "      <th>BHLYP/6-31G* DFT E isomer pi-pi* wavelength in nm</th>\n",
-       "      <th>BHLYP/6-31G* DFT E isomer n-pi* wavelength in nm</th>\n",
-       "      <th>BHLYP/6-31G* Z isomer pi-pi* wavelength in nm</th>\n",
-       "      <th>BHLYP/6-31G* DFT Z isomer n-pi* wavelength in nm</th>\n",
-       "      <th>name</th>\n",
-       "      <th>selfies</th>\n",
-       "      <th>wavelength_cat</th>\n",
-       "    </tr>\n",
-       "  </thead>\n",
-       "  <tbody>\n",
-       "    <tr>\n",
-       "      <th>0</th>\n",
-       "      <td>0</td>\n",
-       "      <td>C[N]1N=NC(=N1)N=NC2=CC=CC=C2</td>\n",
-       "      <td>2.100000e-07</td>\n",
-       "      <td>MeCN</td>\n",
-       "      <td>76.0</td>\n",
-       "      <td>72.0</td>\n",
-       "      <td>310.0</td>\n",
-       "      <td>1.67</td>\n",
-       "      <td>442.0</td>\n",
-       "      <td>0.0373</td>\n",
-       "      <td>...</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>[C][NH0][N][=N][C][=Branch1][Ring2][=N][Ring1]...</td>\n",
-       "      <td>very small</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>1</th>\n",
-       "      <td>1</td>\n",
-       "      <td>C[N]1C=NC(=N1)N=NC2=CC=CC=C2</td>\n",
-       "      <td>3.800000e-07</td>\n",
-       "      <td>MeCN</td>\n",
-       "      <td>90.0</td>\n",
-       "      <td>84.0</td>\n",
-       "      <td>310.0</td>\n",
-       "      <td>1.87</td>\n",
-       "      <td>438.0</td>\n",
-       "      <td>0.0505</td>\n",
-       "      <td>...</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>[C][NH0][C][=N][C][=Branch1][Ring2][=N][Ring1]...</td>\n",
-       "      <td>very small</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>2</th>\n",
-       "      <td>2</td>\n",
-       "      <td>C[N]1C=CC(=N1)N=NC2=CC=CC=C2</td>\n",
-       "      <td>1.100000e-07</td>\n",
-       "      <td>MeCN</td>\n",
-       "      <td>98.0</td>\n",
-       "      <td>97.0</td>\n",
-       "      <td>320.0</td>\n",
-       "      <td>1.46</td>\n",
-       "      <td>425.0</td>\n",
-       "      <td>0.0778</td>\n",
-       "      <td>...</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>[C][NH0][C][=C][C][=Branch1][Ring2][=N][Ring1]...</td>\n",
-       "      <td>very small</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>3</th>\n",
-       "      <td>3</td>\n",
-       "      <td>C[N]1C=C(C)C(=N1)N=NC2=CC=CC=C2</td>\n",
-       "      <td>1.500000e-06</td>\n",
-       "      <td>MeCN</td>\n",
-       "      <td>96.0</td>\n",
-       "      <td>87.0</td>\n",
-       "      <td>325.0</td>\n",
-       "      <td>1.74</td>\n",
-       "      <td>428.0</td>\n",
-       "      <td>0.0612</td>\n",
-       "      <td>...</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>[C][NH0][C][=C][Branch1][C][C][C][=Branch1][Ri...</td>\n",
-       "      <td>very small</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>4</th>\n",
-       "      <td>4</td>\n",
-       "      <td>C[N]1C=C(C=N1)N=NC2=CC=CC=C2</td>\n",
-       "      <td>7.600000e-09</td>\n",
-       "      <td>MeCN</td>\n",
-       "      <td>98.0</td>\n",
-       "      <td>70.0</td>\n",
-       "      <td>328.0</td>\n",
-       "      <td>1.66</td>\n",
-       "      <td>417.0</td>\n",
-       "      <td>0.0640</td>\n",
-       "      <td>...</td>\n",
-       "      <td>427.0</td>\n",
-       "      <td>256.0</td>\n",
-       "      <td>401.0</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>[C][NH0][C][=C][Branch1][Branch1][C][=N][Ring1...</td>\n",
-       "      <td>very small</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>...</th>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "      <td>...</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>387</th>\n",
-       "      <td>400</td>\n",
-       "      <td>OC%38=C%39N=CC=CC%39=C(/N=N/C%40=NC%41=CC(C)=C...</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>456.0</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>...</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>[O][C][=C][N][=C][C][=C][C][Ring1][=Branch1][=...</td>\n",
-       "      <td>medium</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>388</th>\n",
-       "      <td>401</td>\n",
-       "      <td>OC%42=C%43N=CC=CC%43=C(/N=N/C%44=NC%45=CC=CC=C...</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>437.0</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>...</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>[O][C][=C][N][=C][C][=C][C][Ring1][=Branch1][=...</td>\n",
-       "      <td>medium</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>389</th>\n",
-       "      <td>402</td>\n",
-       "      <td>N#CC1C(SC(/N=N/C2=NC(C=CC([N+]([O-])=O)=C3)=C3...</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>545.0</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>...</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>[N][#C][C][C][Branch2][Ring2][#Branch2][S][C][...</td>\n",
-       "      <td>large</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>390</th>\n",
-       "      <td>403</td>\n",
-       "      <td>N#Cc5c(c6ccc(Cl)cc6)c(/N=N/C7=NC(C=CC([N+]([O-...</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>535.0</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>...</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>[N][#C][C][C][Branch1][N][C][=C][C][=C][Branch...</td>\n",
-       "      <td>large</td>\n",
-       "    </tr>\n",
-       "    <tr>\n",
-       "      <th>391</th>\n",
-       "      <td>404</td>\n",
-       "      <td>N#CC9C(SC(/N=N/C%10=NC(C=CC([N+]([O-])=O)=C%11...</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>550.0</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>...</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>NaN</td>\n",
-       "      <td>[N][#C][C][C][Branch2][Ring2][=C][S][C][Branch...</td>\n",
-       "      <td>large</td>\n",
-       "    </tr>\n",
-       "  </tbody>\n",
-       "</table>\n",
-       "<p>392 rows × 37 columns</p>\n",
-       "</div>"
-      ],
-      "text/plain": [
-       "     index                                             SMILES  \\\n",
-       "0        0                       C[N]1N=NC(=N1)N=NC2=CC=CC=C2   \n",
-       "1        1                       C[N]1C=NC(=N1)N=NC2=CC=CC=C2   \n",
-       "2        2                       C[N]1C=CC(=N1)N=NC2=CC=CC=C2   \n",
-       "3        3                    C[N]1C=C(C)C(=N1)N=NC2=CC=CC=C2   \n",
-       "4        4                       C[N]1C=C(C=N1)N=NC2=CC=CC=C2   \n",
-       "..     ...                                                ...   \n",
-       "387    400  OC%38=C%39N=CC=CC%39=C(/N=N/C%40=NC%41=CC(C)=C...   \n",
-       "388    401  OC%42=C%43N=CC=CC%43=C(/N=N/C%44=NC%45=CC=CC=C...   \n",
-       "389    402  N#CC1C(SC(/N=N/C2=NC(C=CC([N+]([O-])=O)=C3)=C3...   \n",
-       "390    403  N#Cc5c(c6ccc(Cl)cc6)c(/N=N/C7=NC(C=CC([N+]([O-...   \n",
-       "391    404  N#CC9C(SC(/N=N/C%10=NC(C=CC([N+]([O-])=O)=C%11...   \n",
-       "\n",
-       "     rate of thermal isomerisation from Z-E in s-1  \\\n",
-       "0                                     2.100000e-07   \n",
-       "1                                     3.800000e-07   \n",
-       "2                                     1.100000e-07   \n",
-       "3                                     1.500000e-06   \n",
-       "4                                     7.600000e-09   \n",
-       "..                                             ...   \n",
-       "387                                            NaN   \n",
-       "388                                            NaN   \n",
-       "389                                            NaN   \n",
-       "390                                            NaN   \n",
-       "391                                            NaN   \n",
-       "\n",
-       "    Solvent used for thermal isomerisation rates  Z PhotoStationaryState  \\\n",
-       "0                                           MeCN                    76.0   \n",
-       "1                                           MeCN                    90.0   \n",
-       "2                                           MeCN                    98.0   \n",
-       "3                                           MeCN                    96.0   \n",
-       "4                                           MeCN                    98.0   \n",
-       "..                                           ...                     ...   \n",
-       "387                                          NaN                     NaN   \n",
-       "388                                          NaN                     NaN   \n",
-       "389                                          NaN                     NaN   \n",
-       "390                                          NaN                     NaN   \n",
-       "391                                          NaN                     NaN   \n",
-       "\n",
-       "     E PhotoStationaryState  E isomer pi-pi* wavelength in nm  Extinction  \\\n",
-       "0                      72.0                             310.0        1.67   \n",
-       "1                      84.0                             310.0        1.87   \n",
-       "2                      97.0                             320.0        1.46   \n",
-       "3                      87.0                             325.0        1.74   \n",
-       "4                      70.0                             328.0        1.66   \n",
-       "..                      ...                               ...         ...   \n",
-       "387                     NaN                             456.0         NaN   \n",
-       "388                     NaN                             437.0         NaN   \n",
-       "389                     NaN                             545.0         NaN   \n",
-       "390                     NaN                             535.0         NaN   \n",
-       "391                     NaN                             550.0         NaN   \n",
-       "\n",
-       "     E isomer n-pi* wavelength in nm  Extinction coefficient in M-1 cm-1  ...  \\\n",
-       "0                              442.0                              0.0373  ...   \n",
-       "1                              438.0                              0.0505  ...   \n",
-       "2                              425.0                              0.0778  ...   \n",
-       "3                              428.0                              0.0612  ...   \n",
-       "4                              417.0                              0.0640  ...   \n",
-       "..                               ...                                 ...  ...   \n",
-       "387                              NaN                                 NaN  ...   \n",
-       "388                              NaN                                 NaN  ...   \n",
-       "389                              NaN                                 NaN  ...   \n",
-       "390                              NaN                                 NaN  ...   \n",
-       "391                              NaN                                 NaN  ...   \n",
-       "\n",
-       "     CAM-B3LYP/6-31G** DFT E isomer n-pi* wavelength in nm  \\\n",
-       "0                                                  NaN       \n",
-       "1                                                  NaN       \n",
-       "2                                                  NaN       \n",
-       "3                                                  NaN       \n",
-       "4                                                427.0       \n",
-       "..                                                 ...       \n",
-       "387                                                NaN       \n",
-       "388                                                NaN       \n",
-       "389                                                NaN       \n",
-       "390                                                NaN       \n",
-       "391                                                NaN       \n",
-       "\n",
-       "     CAM-B3LYP/6-31G** DFT Z isomer pi-pi* wavelength in nm  \\\n",
-       "0                                                  NaN        \n",
-       "1                                                  NaN        \n",
-       "2                                                  NaN        \n",
-       "3                                                  NaN        \n",
-       "4                                                256.0        \n",
-       "..                                                 ...        \n",
-       "387                                                NaN        \n",
-       "388                                                NaN        \n",
-       "389                                                NaN        \n",
-       "390                                                NaN        \n",
-       "391                                                NaN        \n",
-       "\n",
-       "     CAM-B3LYP/6-31G** DFT Z isomer n-pi* wavelength in nm  \\\n",
-       "0                                                  NaN       \n",
-       "1                                                  NaN       \n",
-       "2                                                  NaN       \n",
-       "3                                                  NaN       \n",
-       "4                                                401.0       \n",
-       "..                                                 ...       \n",
-       "387                                                NaN       \n",
-       "388                                                NaN       \n",
-       "389                                                NaN       \n",
-       "390                                                NaN       \n",
-       "391                                                NaN       \n",
-       "\n",
-       "     BHLYP/6-31G* DFT E isomer pi-pi* wavelength in nm  \\\n",
-       "0                                                  NaN   \n",
-       "1                                                  NaN   \n",
-       "2                                                  NaN   \n",
-       "3                                                  NaN   \n",
-       "4                                                  NaN   \n",
-       "..                                                 ...   \n",
-       "387                                                NaN   \n",
-       "388                                                NaN   \n",
-       "389                                                NaN   \n",
-       "390                                                NaN   \n",
-       "391                                                NaN   \n",
-       "\n",
-       "     BHLYP/6-31G* DFT E isomer n-pi* wavelength in nm  \\\n",
-       "0                                                 NaN   \n",
-       "1                                                 NaN   \n",
-       "2                                                 NaN   \n",
-       "3                                                 NaN   \n",
-       "4                                                 NaN   \n",
-       "..                                                ...   \n",
-       "387                                               NaN   \n",
-       "388                                               NaN   \n",
-       "389                                               NaN   \n",
-       "390                                               NaN   \n",
-       "391                                               NaN   \n",
-       "\n",
-       "    BHLYP/6-31G* Z isomer pi-pi* wavelength in nm  \\\n",
-       "0                                             NaN   \n",
-       "1                                             NaN   \n",
-       "2                                             NaN   \n",
-       "3                                             NaN   \n",
-       "4                                             NaN   \n",
-       "..                                            ...   \n",
-       "387                                           NaN   \n",
-       "388                                           NaN   \n",
-       "389                                           NaN   \n",
-       "390                                           NaN   \n",
-       "391                                           NaN   \n",
-       "\n",
-       "    BHLYP/6-31G* DFT Z isomer n-pi* wavelength in nm name  \\\n",
-       "0                                                NaN  NaN   \n",
-       "1                                                NaN  NaN   \n",
-       "2                                                NaN  NaN   \n",
-       "3                                                NaN  NaN   \n",
-       "4                                                NaN  NaN   \n",
-       "..                                               ...  ...   \n",
-       "387                                              NaN  NaN   \n",
-       "388                                              NaN  NaN   \n",
-       "389                                              NaN  NaN   \n",
-       "390                                              NaN  NaN   \n",
-       "391                                              NaN  NaN   \n",
-       "\n",
-       "                                               selfies  wavelength_cat  \n",
-       "0    [C][NH0][N][=N][C][=Branch1][Ring2][=N][Ring1]...      very small  \n",
-       "1    [C][NH0][C][=N][C][=Branch1][Ring2][=N][Ring1]...      very small  \n",
-       "2    [C][NH0][C][=C][C][=Branch1][Ring2][=N][Ring1]...      very small  \n",
-       "3    [C][NH0][C][=C][Branch1][C][C][C][=Branch1][Ri...      very small  \n",
-       "4    [C][NH0][C][=C][Branch1][Branch1][C][=N][Ring1...      very small  \n",
-       "..                                                 ...             ...  \n",
-       "387  [O][C][=C][N][=C][C][=C][C][Ring1][=Branch1][=...          medium  \n",
-       "388  [O][C][=C][N][=C][C][=C][C][Ring1][=Branch1][=...          medium  \n",
-       "389  [N][#C][C][C][Branch2][Ring2][#Branch2][S][C][...           large  \n",
-       "390  [N][#C][C][C][Branch1][N][C][=C][C][=C][Branch...           large  \n",
-       "391  [N][#C][C][C][Branch2][Ring2][=C][S][C][Branch...           large  \n",
-       "\n",
-       "[392 rows x 37 columns]"
-      ]
-     },
-     "execution_count": 4,
-     "metadata": {},
-     "output_type": "execute_result"
-    }
-   ],
+   "outputs": [],
+   "source": [
+    "train_size  = len(train_prompts)\n",
+    "test_size = len(test_prompts)\n",
+    "\n",
+    "filename_base = time.strftime(\"%Y-%m-%d-%H-%M-%S\", time.localtime())\n",
+    "train_filename = f\"run_files/{filename_base}_train_prompts_polymers_{train_size}.jsonl\"\n",
+    "valid_filename = f\"run_files/{filename_base}_valid_prompts_polymers_{test_size}.jsonl\"\n",
+    "\n",
+    "train_prompts.to_json(train_filename, orient=\"records\", lines=True)\n",
+    "test_prompts.to_json(valid_filename, orient=\"records\", lines=True)\n"
+   ]
+  },
+  {
+   "cell_type": "code",
+   "execution_count": 14,
+   "metadata": {},
+   "outputs": [],
    "source": [
-    "data\n"
+    "fine_tune(train_filename, valid_filename, \"ada\")"
    ]
   },
   {
diff --git a/experiments/wandb/latest-run b/experiments/wandb/latest-run
index 7d3f30a..96cf187 120000
--- a/experiments/wandb/latest-run
+++ b/experiments/wandb/latest-run
@@ -1 +1 @@
-run-20220827_112334-ft-g029LgIAwN4ACJ2Wh7zOLkPe
\ No newline at end of file
+run-20220831_112133-ft-ZTxafJhLHFoI8mc5JUlWiiWo
\ No newline at end of file
diff --git a/notebooks/03_input.ipynb b/notebooks/03_input.ipynb
index 3e633d0..c135f94 100644
--- a/notebooks/03_input.ipynb
+++ b/notebooks/03_input.ipynb
@@ -631,6 +631,13 @@
     "## Polymers\n"
    ]
   },
+  {
+   "cell_type": "markdown",
+   "metadata": {},
+   "source": [
+    "Polymer specific prompt generation methods."
+   ]
+  },
   {
    "cell_type": "code",
    "execution_count": null,
diff --git a/notebooks/04_output.ipynb b/notebooks/04_output.ipynb
index 4170447..2aeee4a 100644
--- a/notebooks/04_output.ipynb
+++ b/notebooks/04_output.ipynb
@@ -27,14 +27,14 @@
     "from strsimpy.normalized_levenshtein import NormalizedLevenshtein\n",
     "\n",
     "\n",
-    "from sklearn.metrics import r2_score, max_error, mean_absolute_error, mean_squared_error"
+    "from sklearn.metrics import r2_score, max_error, mean_absolute_error, mean_squared_error\n"
    ]
   },
   {
    "cell_type": "markdown",
    "metadata": {},
    "source": [
-    "# Reusable code for analyzing results\n",
+    "# Analyzing results\n",
     "\n",
     "> Analyze the outputs of the models\n"
    ]
@@ -53,7 +53,10 @@
    "outputs": [],
    "source": [
     "# |export\n",
-    "def string_distances(training_set: Iterable[str], query_string: str):\n",
+    "def string_distances(\n",
+    "    training_set: Iterable[str], # string representations of the compounds in the training set\n",
+    "    query_string: str # string representation of the compound to be queried\n",
+    "):\n",
     "\n",
     "    distances = defaultdict(list)\n",
     "\n",
@@ -117,6 +120,7 @@
    "source": [
     "# |export\n",
     "\n",
+    "\n",
     "def convert2smiles(string):\n",
     "    new_encoding = {\"A\": \"[Ta]\", \"B\": \"[Tr]\", \"W\": \"[W]\", \"R\": \"[R]\"}\n",
     "\n",
@@ -222,6 +226,7 @@
    "source": [
     "# |export\n",
     "\n",
+    "\n",
     "def get_target(string, target_name=\"adsorption\"):\n",
     "    num = re.findall(f\"([\\d+]) {target_name}\", string)\n",
     "    return int(num[0])\n"
@@ -235,6 +240,7 @@
    "source": [
     "# |export\n",
     "\n",
+    "\n",
     "def get_prompt_data(prompt):\n",
     "    composition = get_prompt_compostion(prompt)\n",
     "\n",
@@ -249,6 +255,7 @@
    "source": [
     "# |export\n",
     "\n",
+    "\n",
     "def get_completion_composition(string):\n",
     "    parts = string.split(\"-\")\n",
     "    counts = Counter(parts)\n",
@@ -262,6 +269,7 @@
    "outputs": [],
    "source": [
     "# |export\n",
+    "import pandas as pd\n",
     "\n",
     "def string2performance(string):\n",
     "    # we need to perform a bunch of tasks here:\n",
@@ -291,6 +299,7 @@
    "source": [
     "# |export\n",
     "\n",
+    "\n",
     "def composition_mismatch(composition: dict, found: dict):\n",
     "    distances = []\n",
     "\n",
@@ -334,13 +343,17 @@
    "source": [
     "# |export\n",
     "\n",
-    "def get_regression_metrics(y_true, y_pred):\n",
+    "\n",
+    "def get_regression_metrics(\n",
+    "    y_true: np.typing.ArrayLike,  # actual values\n",
+    "    y_pred: np.typing.ArrayLike,  # predicted values\n",
+    ") -> dict:\n",
     "    return {\n",
     "        \"r2\": r2_score(y_true, y_pred),\n",
     "        \"max_error\": max_error(y_true, y_pred),\n",
     "        \"mean_absolute_error\": mean_absolute_error(y_true, y_pred),\n",
     "        \"mean_squared_error\": mean_squared_error(y_true, y_pred),\n",
-    "    }"
+    "    }\n"
    ]
   },
   {
@@ -363,9 +376,7 @@
     }
    ],
    "source": [
-    "get_regression_metrics(\n",
-    "    [1, 2, 3, 4, 5], [1, 2, 3, 4, 5]\n",
-    ")"
+    "get_regression_metrics([1, 2, 3, 4, 5], [1, 2, 3, 4, 5])\n"
    ]
   },
   {
